#-----------------------------------
# On Actions
#-----------------------------------
on_siege_won_province__stratagems = {
    # Defensive Stratagems
    martyrdom_stratagem = yes
    sabotage_stratagem = yes
    slander_stratagem = yes
    
    # Insurrection Stratagems
    bribery_stratagem = yes
    compromise_stratagem = yes
    garrison_stratagem = yes
}

on_siege_lost_province__stratagems = {
    # Offensive Stratagems
    sow_terror_stratagem = yes
    slash_and_burn_stratagem = yes
    enslavement_stratagem = yes
    purification_stratagem = yes
}

#-----------------------------------
# Misc
#-----------------------------------
setup_default_stratagem_assignment = {
    # Default for all
    set_offensive_stratagem = { TYPE = standard }
    set_defensive_stratagem = { TYPE = standard }
    set_insurrection_stratagem = { TYPE = standard }
    
    # Stratagem Levels
    set_stratagem_level__slash_and_burn = yes
    set_stratagem_level__enslavement = yes
    set_stratagem_level__purification = yes
    
    set_stratagem_level__martyrdom = yes
    set_stratagem_level__sabotage = yes
    set_stratagem_level__slander = yes
    
    set_stratagem_level__bribery = yes
    set_stratagem_level__compromise = yes
    set_stratagem_level__garrison = yes
}

set_offensive_stratagem = {
    hidden_effect = {
        clr_country_flag = offensive_stratagem__standard
        clr_country_flag = offensive_stratagem__sow_terror
        clr_country_flag = offensive_stratagem__slash_and_burn
        clr_country_flag = offensive_stratagem__enslavement
        clr_country_flag = offensive_stratagem__purification

        set_country_flag = offensive_stratagem__$TYPE$
    }
    
    custom_tooltip = OFFENSIVE_STRATAGEM_$TYPE$_TT
}

set_defensive_stratagem = {
    hidden_effect = {
        clr_country_flag = defensive_stratagem__standard
        clr_country_flag = defensive_stratagem__martyrdom
        clr_country_flag = defensive_stratagem__sabotage
        clr_country_flag = defensive_stratagem__slander
        
        set_country_flag = defensive_stratagem__$TYPE$
    }
    custom_tooltip = DEFENSIVE_STRATAGEM_$TYPE$_TT
}

set_insurrection_stratagem = {
    hidden_effect = {
        clr_country_flag = insurrection_stratagem__standard
        clr_country_flag = insurrection_stratagem__bribery
        clr_country_flag = insurrection_stratagem__compromise
        clr_country_flag = insurrection_stratagem__garrison

        set_country_flag = insurrection_stratagem__$TYPE$
    }
    
    custom_tooltip = INSURRECTION_STRATAGEM_$TYPE$_TT
}

# NOTE: these do not use $VAR$ since it causes a CTD on load
# Set Stratagem Level
set_stratagem_level__slash_and_burn = {
    hidden_effect = {
        set_variable = {
            which = offensive_slash_and_burn_stratagem_level
            value = 1
        }
    }
}
set_stratagem_level__enslavement = {
    hidden_effect = {
        set_variable = {
            which = offensive_enslavement_stratagem_level
            value = 1
        }
    }
}
set_stratagem_level__purification = {
    hidden_effect = {
        set_variable = {
            which = offensive_purification_stratagem_level
            value = 1
        }
    }
}
set_stratagem_level__martyrdom = {
    hidden_effect = {
        set_variable = {
            which = defensive_martyrdom_stratagem_level
            value = 1
        }
    }
}
set_stratagem_level__sabotage = {
    hidden_effect = {
        set_variable = {
            which = defensive_sabotage_stratagem_level
            value = 1
        }
    }
}
set_stratagem_level__slander = {
    hidden_effect = {
        set_variable = {
            which = defensive_slander_stratagem_level
            value = 1
        }
    }
}
set_stratagem_level__bribery = {
    hidden_effect = {
        set_variable = {
            which = insurrection_bribery_stratagem_level
            value = 1
        }
    }
}
set_stratagem_level__compromise = {
    hidden_effect = {
        set_variable = {
            which = insurrection_compromise_stratagem_level
            value = 1
        }
    }
}
set_stratagem_level__garrison = {
    hidden_effect = {
        set_variable = {
            which = insurrection_garrison_stratagem_level
            value = 1
        }
    }
}

# Increase Stratagem Level
increase_stratagem_level__slash_and_burn = {
    hidden_effect = {
        change_variable = {
            which = offensive_slash_and_burn_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                check_variable = {
                    which = offensive_slash_and_burn_stratagem_level
                    value = 5
                }
            }
            set_variable = {
                which = offensive_slash_and_burn_stratagem_level
                value = 5
            }
        }
    }
}
increase_stratagem_level__enslavement = {
    hidden_effect = {
        change_variable = {
            which = offensive_enslavement_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                check_variable = {
                    which = offensive_enslavement_stratagem_level
                    value = 5
                }
            }
            set_variable = {
                which = offensive_enslavement_stratagem_level
                value = 5
            }
        }
    }
}
increase_stratagem_level__purification = {
    hidden_effect = {
        change_variable = {
            which = offensive_purification_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                check_variable = {
                    which = offensive_purification_stratagem_level
                    value = 5
                }
            }
            set_variable = {
                which = offensive_purification_stratagem_level
                value = 5
            }
        }
    }
}

increase_stratagem_level__martyrdom = {
    hidden_effect = {
        change_variable = {
            which = defensive_martyrdom_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                check_variable = {
                    which = defensive_martyrdom_stratagem_level
                    value = 5
                }
            }
            set_variable = {
                which = defensive_martyrdom_stratagem_level
                value = 5
            }
        }
    }
}
increase_stratagem_level__sabotage = {
    hidden_effect = {
        change_variable = {
            which = defensive_sabotage_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                check_variable = {
                    which = defensive_sabotage_stratagem_level
                    value = 5
                }
            }
            set_variable = {
                which = defensive_sabotage_stratagem_level
                value = 5
            }
        }
    }
}
increase_stratagem_level__slander = {
    hidden_effect = {
        change_variable = {
            which = defensive_slander_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                check_variable = {
                    which = defensive_slander_stratagem_level
                    value = 5
                }
            }
            set_variable = {
                which = defensive_slander_stratagem_level
                value = 5
            }
        }
    }
}

increase_stratagem_level__bribery = {
    hidden_effect = {
        change_variable = {
            which = insurrection_bribery_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                check_variable = {
                    which = insurrection_bribery_stratagem_level
                    value = 5
                }
            }
            set_variable = {
                which = insurrection_bribery_stratagem_level
                value = 5
            }
        }
    }
}
increase_stratagem_level__compromise = {
    hidden_effect = {
        change_variable = {
            which = insurrection_compromise_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                check_variable = {
                    which = insurrection_compromise_stratagem_level
                    value = 5
                }
            }
            set_variable = {
                which = insurrection_compromise_stratagem_level
                value = 5
            }
        }
    }
}
increase_stratagem_level__garrison = {
    hidden_effect = {
        change_variable = {
            which = insurrection_garrison_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                check_variable = {
                    which = insurrection_garrison_stratagem_level
                    value = 5
                }
            }
            set_variable = {
                which = insurrection_garrison_stratagem_level
                value = 5
            }
        }
    }
}

# Decrease Stratagem Level
decrease_stratagem_level__slash_and_burn = {
    hidden_effect = {
        subtract_variable = {
            which = offensive_slash_and_burn_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = offensive_slash_and_burn_stratagem_level
                        value = 1
                    }
                }
            }
            set_variable = {
                which = offensive_slash_and_burn_stratagem_level
                value = 1
            }
        }
    }
}
decrease_stratagem_level__enslavement = {
    hidden_effect = {
        subtract_variable = {
            which = offensive_enslavement_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = offensive_enslavement_stratagem_level
                        value = 1
                    }
                }
            }
            set_variable = {
                which = offensive_enslavement_stratagem_level
                value = 1
            }
        }
    }
}
decrease_stratagem_level__purification = {
    hidden_effect = {
        subtract_variable = {
            which = offensive_purification_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = offensive_purification_stratagem_level
                        value = 1
                    }
                }
            }
            set_variable = {
                which = offensive_purification_stratagem_level
                value = 1
            }
        }
    }
}

decrease_stratagem_level__martyrdom = {
    hidden_effect = {
        subtract_variable = {
            which = defensive_martyrdom_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = defensive_martyrdom_stratagem_level
                        value = 1
                    }
                }
            }
            set_variable = {
                which = defensive_martyrdom_stratagem_level
                value = 1
            }
        }
    }
}
decrease_stratagem_level__sabotage = {
    hidden_effect = {
        subtract_variable = {
            which = defensive_sabotage_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = defensive_sabotage_stratagem_level
                        value = 1
                    }
                }
            }
            set_variable = {
                which = defensive_sabotage_stratagem_level
                value = 1
            }
        }
    }
}
decrease_stratagem_level__slander = {
    hidden_effect = {
        subtract_variable = {
            which = defensive_slander_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = defensive_slander_stratagem_level
                        value = 1
                    }
                }
            }
            set_variable = {
                which = defensive_slander_stratagem_level
                value = 1
            }
        }
    }
}

decrease_stratagem_level__bribery = {
    hidden_effect = {
        subtract_variable = {
            which = insurrection_bribery_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = insurrection_bribery_stratagem_level
                        value = 1
                    }
                }
            }
            set_variable = {
                which = insurrection_bribery_stratagem_level
                value = 1
            }
        }
    }
}
decrease_stratagem_level__compromise = {
    hidden_effect = {
        subtract_variable = {
            which = insurrection_compromise_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = insurrection_compromise_stratagem_level
                        value = 1
                    }
                }
            }
            set_variable = {
                which = insurrection_compromise_stratagem_level
                value = 1
            }
        }
    }
}
decrease_stratagem_level__garrison = {
    hidden_effect = {
        subtract_variable = {
            which = insurrection_garrison_stratagem_level
            value = 1
        }
        
        if = {
            limit = {
                NOT = {
                    check_variable = {
                        which = insurrection_garrison_stratagem_level
                        value = 1
                    }
                }
            }
            set_variable = {
                which = insurrection_garrison_stratagem_level
                value = 1
            }
        }
    }
}


take_offensive_stratagem_cost = {
    add_years_of_income = -1
    add_mil_power = -200
}

take_defensive_stratagem_cost = {
    add_years_of_income = -1
    add_mil_power = -200
}

take_insurrection_stratagem_cost = {
    add_years_of_income = -1
    add_mil_power = -200
}

# Sow Terror
sow_terror_stratagem = {
    if = {
        limit = {
            FROM = {
                has_offensive_stratagem__sow_terror = yes
            }
        }
        
        if = {
            limit = {
                FROM = {
                    mil_power = 5
                }
            }
            
            FROM = {
                add_mil_power = -5
            }
        
            every_neighbor_province = {
                limit = {   
                    # Only affect war enemies
                    owner = {
                        war_with = FROM
                    }
                    NOT = { fort_level = 1 }
                    NOT = { controlled_by = FROM }
                    controlled_by = owner # Affect only those owner still controls
                }
                
                change_controller = FROM
            }
        }
    }
}

# Slash and Burn
slash_and_burn_stratagem = {
    if = {
        limit = {
            FROM = {
                has_offensive_stratagem__slash_and_burn = yes
            }
            NOT = { owned_by = FROM } # Stop any issues where FROM re-sieges there own province, and applies devastation
        }
        
        # Level 1
        if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_slash_and_burn_stratagem_level
                        value = 1
                    }
                }
            }
            if = {
                limit = {
                    FROM = {
                        mil_power = 1
                    }
                }
                
                FROM = {
                    add_mil_power = -1
                }
            
                add_devastation = 20
            }
        }
        # Level 2
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_slash_and_burn_stratagem_level
                        value = 2
                    }
                }
            }
            if = {
                limit = {
                    FROM = {
                        mil_power = 2
                    }
                }
                
                FROM = {
                    add_mil_power = -2
                }
            
                add_devastation = 40
            }
        }
        # Level 3
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_slash_and_burn_stratagem_level
                        value = 3
                    }
                }
            }
            if = {
                limit = {
                    FROM = {
                        mil_power = 3
                    }
                }
                
                FROM = {
                    add_mil_power = -3
                }
            
                add_devastation = 60
            }
        }
        # Level 4
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_slash_and_burn_stratagem_level
                        value = 4
                    }
                }
            }
            if = {
                limit = {
                    FROM = {
                        mil_power = 4
                    }
                }
                
                FROM = {
                    add_mil_power = -4
                }
            
                add_devastation = 80
            }
        }
        # Level 5
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_slash_and_burn_stratagem_level
                        value = 5
                    }
                }
            }
            if = {
                limit = {
                    FROM = {
                        mil_power = 5
                    }
                }
                
                FROM = {
                    add_mil_power = -5
                }
            
                add_devastation = 100
            }
        }
    }
}

# Enslavement
enslavement_stratagem = {
    if = {
        limit = {
            FROM = {
                has_offensive_stratagem__enslavement = yes
            }
            NOT = { owned_by = FROM } # Stop any issues where FROM re-sieges there own province, and applies devastation
        }
        
        # Level 1
        if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_enslavement_stratagem_level
                        value = 1
                    }
                }
            }
            if = {
                limit = {
                    FROM = {
                        mil_power = 1
                    }
                }
                
                FROM = {
                    add_mil_power = -1
                }
            
                FROM = { add_manpower = 0.2 }
            }
        }
        # Level 2
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_enslavement_stratagem_level
                        value = 2
                    }
                }
            }
            if = {
                limit = {
                    FROM = {
                        mil_power = 2
                    }
                }
                
                FROM = {
                    add_mil_power = -2
                }
            
                FROM = { add_manpower = 0.4 }
            }
        }
        # Level 3
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_enslavement_stratagem_level
                        value = 3
                    }
                }
            }
            if = {
                limit = {
                    FROM = {
                        mil_power = 3
                    }
                }
                
                FROM = {
                    add_mil_power = -3
                }
            
                FROM = { add_manpower = 0.6 }
            }
        }
        # Level 4
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_enslavement_stratagem_level
                        value = 4
                    }
                }
            }
            if = {
                limit = {
                    FROM = {
                        mil_power = 4
                    }
                }
                
                FROM = {
                    add_mil_power = -4
                }
            
                FROM = { add_manpower = 0.8 }
            }
        }
        # Level 5
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_enslavement_stratagem_level
                        value = 5
                    }
                }
            }
            if = {
                limit = {
                    FROM = {
                        mil_power = 5
                    }
                }
                
                FROM = {
                    add_mil_power = -5
                }
            
                FROM = { add_manpower = 1.0 }
            }
        }
    }
}

# Purification
purification_stratagem = {
    if = {
        limit = {
            FROM = {
                has_offensive_stratagem__purification = yes
            }
            NOT = { owned_by = FROM } # Stop any issues where FROM re-sieges there own province, and applies devastation
        }
        
        # Level 1
        if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_purification_stratagem_level
                        value = 1
                    }
                }
            }
            
            if = {
                limit = {
                    is_capital = no
                    NOT = { development = 12 }
                    FROM = {
                        mil_power = 4
                    }
                }
                
                FROM = {
                    add_mil_power = -4
                }
            
                change_culture = FROM
                change_religion = FROM
            }
        }
        # Level 2
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_purification_stratagem_level
                        value = 2
                    }
                }
            }
            if = {
                limit = {
                    is_capital = no
                    NOT = { development = 14 }
                    FROM = {
                        mil_power = 5
                    }
                }
                
                FROM = {
                    add_mil_power = -5
                }
            
                change_culture = FROM
                change_religion = FROM
            }
        }
        # Level 3
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_purification_stratagem_level
                        value = 3
                    }
                }
            }
            if = {
                limit = {
                    is_capital = no
                    NOT = { development = 16 }
                    FROM = {
                        mil_power = 6
                    }
                }
                
                FROM = {
                    add_mil_power = -6
                }
            
                change_culture = FROM
                change_religion = FROM
            }
        }
        # Level 4
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_purification_stratagem_level
                        value = 4
                    }
                }
            }
            if = {
                limit = {
                    is_capital = no
                    NOT = { development = 18 }
                    FROM = {
                        mil_power = 7
                    }
                }
                
                FROM = {
                    add_mil_power = -7
                }
            
                change_culture = FROM
                change_religion = FROM
            }
        }
        # Level 5
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = offensive_purification_stratagem_level
                        value = 5
                    }
                }
            }
            if = {
                limit = {
                    is_capital = no
                    NOT = { development = 20 }
                    FROM = {
                        mil_power = 8
                    }
                }
                
                FROM = {
                    add_mil_power = -8
                }
            
                change_culture = FROM
                change_religion = FROM
            }
        }
    }
}

# Martyrdom
martyrdom_stratagem = {
    if = {
        limit = {
            FROM = {
                has_defensive_stratagem__martyrdom = yes
            }
            # Don't trigger for self-sieges
            controller = {
                NOT = { tag = FROM }
            }
        }
        
        # Level 1
        if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_martyrdom_stratagem_level
                        value = 1
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 1
                    }
                }
                
                FROM = {
                    add_mil_power = -1
                }
            
                controller = {
                    add_manpower = -0.2
                }
            }
        }
        # Level 2
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_martyrdom_stratagem_level
                        value = 2
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 2
                    }
                }
                
                FROM = {
                    add_mil_power = -2
                }
            
                controller = {
                    add_manpower = -0.4
                }
            }
        }
        # Level 3
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_martyrdom_stratagem_level
                        value = 3
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 3
                    }
                }
                
                FROM = {
                    add_mil_power = -3
                }
            
                controller = {
                    add_manpower = -0.6
                }
            }
        }
        # Level 4
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_martyrdom_stratagem_level
                        value = 4
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 4
                    }
                }
                
                FROM = {
                    add_mil_power = -4
                }
            
                controller = {
                    add_manpower = -0.8
                }
            }
        }
        # Level 5
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_martyrdom_stratagem_level
                        value = 5
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 5
                    }
                }
                
                FROM = {
                    add_mil_power = -5
                }
            
                controller = {
                    add_manpower = -1.0
                }
            }
        }
    }
}

# Sabotage
sabotage_stratagem = {
    if = {
        limit = {
            FROM = {
                has_defensive_stratagem__sabotage = yes
            }
            # Don't trigger for self-sieges
            controller = {
                NOT = { tag = FROM }
            }
        }
        
        # Level 1
        if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_sabotage_stratagem_level
                        value = 1
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 1
                    }
                }
                
                FROM = {
                    add_mil_power = -1
                }
            
                controller = {
                    add_treasury = -10
                }
            }
        }
        # Level 2
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_sabotage_stratagem_level
                        value = 2
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 2
                    }
                }
                
                FROM = {
                    add_mil_power = -2
                }
            
                controller = {
                    add_treasury = -20
                }
            }
        }
        # Level 3
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_sabotage_stratagem_level
                        value = 3
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 3
                    }
                }
                
                FROM = {
                    add_mil_power = -3
                }
            
                controller = {
                    add_treasury = -30
                }
            }
        }
        # Level 4
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_sabotage_stratagem_level
                        value = 4
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 4
                    }
                }
                
                FROM = {
                    add_mil_power = -4
                }
            
                controller = {
                    add_treasury = -40
                }
            }
        }
        # Level 5
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_sabotage_stratagem_level
                        value = 5
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 5
                    }
                }
                
                FROM = {
                    add_mil_power = -5
                }
            
                controller = {
                    add_treasury = -50
                }
            }
        }
    }
}

# Slander
slander_stratagem = {
    if = {
        limit = {
            FROM = {
                has_defensive_stratagem__slander = yes
            }
            # Don't trigger for self-sieges
            controller = {
                NOT = { tag = FROM }
            }
        }
        
        # Level 1
        if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_slander_stratagem_level
                        value = 1
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 1
                    }
                }
                
                FROM = {
                    add_mil_power = -1
                }
            
                controller = {
                    add_prestige = -1
                }
            }
        }
        # Level 2
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_slander_stratagem_level
                        value = 2
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 2
                    }
                }
                
                FROM = {
                    add_mil_power = -2
                }
            
                controller = {
                    add_prestige = -2
                }
            }
        }
        # Level 3
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_slander_stratagem_level
                        value = 3
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 3
                    }
                }
                
                FROM = {
                    add_mil_power = -3
                }
            
                controller = {
                    add_prestige = -3
                }
            }
        }
        # Level 4
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_slander_stratagem_level
                        value = 4
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 4
                    }
                }
                
                FROM = {
                    add_mil_power = -4
                }
            
                controller = {
                    add_prestige = -4
                }
            }
        }
        # Level 5
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = defensive_slander_stratagem_level
                        value = 5
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        mil_power = 5
                    }
                }
                
                FROM = {
                    add_mil_power = -5
                }
            
                controller = {
                    add_prestige = -5
                }
            }
        }
    }
}

# Bribery
bribery_stratagem = {
    if = {
        limit = {
            FROM = {
                has_insurrection_stratagem__bribery = yes
            }
            # Only trigger for rebels
            controller = {
                tag = REB
            }
        }
        
        # Level 1
        if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_bribery_stratagem_level
                        value = 1
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        treasury = 10
                    }
                }
                
                FROM = {
                    add_treasury = -10
                }
            
                province_event = { id = wwu_stratagems.50 days = 1 } # Rebel Kill 10
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 2
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_bribery_stratagem_level
                        value = 2
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        treasury = 20
                    }
                }
                
                FROM = {
                    add_treasury = -20
                }
            
                province_event = { id = wwu_stratagems.51 days = 1 } # Rebel Kill 15
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 3
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_bribery_stratagem_level
                        value = 3
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        treasury = 30
                    }
                }
                
                FROM = {
                    add_treasury = -30
                }
            
                province_event = { id = wwu_stratagems.52 days = 1 } # Rebel Kill 20
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 4
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_bribery_stratagem_level
                        value = 4
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        treasury = 40
                    }
                }
                
                FROM = {
                    add_treasury = -40
                }
            
                province_event = { id = wwu_stratagems.53 days = 1 } # Rebel Kill 25
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 5
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_bribery_stratagem_level
                        value = 5
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        treasury = 50
                    }
                }
                
                FROM = {
                    add_treasury = -50
                }
            
                province_event = { id = wwu_stratagems.54 days = 1 } # Rebel Kill 30
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
    }
}

# Compromise
compromise_stratagem = {
    if = {
        limit = {
            FROM = {
                has_insurrection_stratagem__compromise = yes
            }
            # Only trigger for rebels
            controller = {
                tag = REB
            }
        }
        
        # Level 1
        if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_compromise_stratagem_level
                        value = 1
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        NOT = { corruption = 100 }
                    }
                }
                
                FROM = {
                    add_corruption = 0.2
                }
            
                province_event = { id = wwu_stratagems.52 days = 1 } # Rebel Kill 20
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 2
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_compromise_stratagem_level
                        value = 2
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        NOT = { corruption = 100 }
                    }
                }
                
                FROM = {
                    add_corruption = 0.4
                }
            
                province_event = { id = wwu_stratagems.53 days = 1 } # Rebel Kill 25
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 3
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_compromise_stratagem_level
                        value = 3
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        NOT = { corruption = 100 }
                    }
                }
                
                FROM = {
                    add_corruption = 0.6
                }
            
                province_event = { id = wwu_stratagems.54 days = 1 } # Rebel Kill 30
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 4
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_compromise_stratagem_level
                        value = 4
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        NOT = { corruption = 100 }
                    }
                }
                
                FROM = {
                    add_corruption = 0.8
                }
            
                province_event = { id = wwu_stratagems.55 days = 1 } # Rebel Kill 35
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 5
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_compromise_stratagem_level
                        value = 5
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        NOT = { corruption = 100 }
                    }
                }
                
                FROM = {
                    add_corruption = 1.0
                }
            
                province_event = { id = wwu_stratagems.56 days = 1 } # Rebel Kill 40
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
    }
}

# Garrison
garrison_stratagem = {
    if = {
        limit = {
            FROM = {
                has_insurrection_stratagem__garrison = yes
            }
            # Only trigger for rebels
            controller = {
                tag = REB
            }
        }
        
        # Level 1
        if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_garrison_stratagem_level
                        value = 1
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        manpower = 0.2
                    }
                }
                
                FROM = {
                    add_manpower = -0.2
                }
            
                province_event = { id = wwu_stratagems.50 days = 1 } # Rebel Kill 10
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 2
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_garrison_stratagem_level
                        value = 2
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        manpower = 0.4
                    }
                }
                
                FROM = {
                    add_manpower = -0.4
                }
            
                province_event = { id = wwu_stratagems.51 days = 1 } # Rebel Kill 5
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 3
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_garrison_stratagem_level
                        value = 3
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        manpower = 0.6
                    }
                }
                
                FROM = {
                    add_manpower = -0.6
                }
            
                province_event = { id = wwu_stratagems.52 days = 1 } # Rebel Kill 20
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 4
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_garrison_stratagem_level
                        value = 4
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        manpower = 0.8
                    }
                }
                
                FROM = {
                    add_manpower = -0.8
                }
            
                province_event = { id = wwu_stratagems.53 days = 1 } # Rebel Kill 25
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
        # Level 5
        else_if = {
            limit = {
                FROM = {
                    is_variable_equal = {
                        which = insurrection_garrison_stratagem_level
                        value = 5
                    }
                }
            }
            
            if = {
                limit = {
                    FROM = {
                        manpower = 1.0
                    }
                }
                
                FROM = {
                    add_manpower = -1.0
                }
            
                province_event = { id = wwu_stratagems.54 days = 1 } # Rebel Kill 30
                province_event = { id = wwu_stratagems.60 days = 1 } # Rebel Occupation Clear
            }
        }
    }
}